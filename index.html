<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Verification Required</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{box-sizing:border-box}

body{
  margin:0;
  font-family:system-ui,-apple-system,BlinkMacSystemFont,Arial,sans-serif;
  background:radial-gradient(circle at top,#0f172a,#020617);
  color:#fff;
  display:flex;
  align-items:center;
  justify-content:center;
  height:100vh;
}

.box{
  background:#020617;
  padding:30px 24px;
  border-radius:18px;
  width:92%;
  max-width:380px;
  text-align:center;
  box-shadow:0 0 40px rgba(56,189,248,.22);
  border:1px solid rgba(56,189,248,.18);
}

h2{
  margin:0 0 12px;
  font-size:22px;
  font-weight:800;
}

.desc{
  font-size:14px;
  color:#cbd5f5;
  margin-bottom:18px;
}

.timer{
  font-size:36px;
  font-weight:900;
  color:#38bdf8;
  margin-bottom:14px;
  display:flex;
  align-items:center;
  justify-content:center;
  gap:10px;
}

button{
  width:100%;
  padding:15px;
  border:none;
  border-radius:12px;
  font-size:16px;
  font-weight:800;
  background:#334155;
  color:#94a3b8;
  cursor:not-allowed;
  transition:.25s;
}

button.active{
  background:linear-gradient(135deg,#38bdf8,#0ea5e9);
  color:#020617;
  cursor:pointer;
  box-shadow:0 0 25px rgba(56,189,248,.45);
}

button.tg{
  margin-top:14px;
  background:linear-gradient(135deg,#22c55e,#16a34a);
  color:#020617;
  box-shadow:0 0 25px rgba(34,197,94,.45);
  cursor:pointer;
}
.ad-box{
  max-height: 160px;          /* üëà ad ko limit */
  overflow: hidden;           /* üëà extra content cut */
  margin: 14px 0;
  border-radius: 12px;
  background: rgba(15,23,42,.6);
}

/* Native banner images control */
.ad-box img,
.ad-box iframe{
  max-height: 160px !important;
  object-fit: contain;
}
</style>
</head>

<body>

<div class="box" id="stepBox">
  <h2>üîê Verification Required</h2>

  <div class="desc">
    Please stay on this page until the verification process finishes.
  </div>

  <div class="timer" id="count">10</div>
  <!-- Adsterra Native Banner -->
<div class="ad-box">
  <script async="async" data-cfasync="false"
    src="https://pl28515428.effectivegatecpm.com/1c897d0a1597b55d0d6ee4e01f2fb496/invoke.js">
  </script>
  <div id="container-1c897d0a1597b55d0d6ee4e01f2fb496"></div>
</div>

  <button id="btn">Continue Verification</button>
</div>

<script>
const AD_LINK =
  "https://www.effectivegatecpm.com/qc7ch8wiw4?key=bb839d04666cd63e6a3cb3dbeeaa2c88";

/* üîÅ CHANGE ONLY THIS */
const BOT_USERNAME = "Insta_Info_Tracker_Bot";

/* ---------- SVG ICON ---------- */
const CHECK_SVG = `
<svg width="34" height="34" viewBox="0 0 24 24" fill="none"
     xmlns="http://www.w3.org/2000/svg">
  <path d="M20 6L9 17L4 12"
        stroke="#22c55e"
        stroke-width="3"
        stroke-linecap="round"
        stroke-linejoin="round"/>
</svg>`;

/* ---------- OPEN TELEGRAM APP (NOT CHROME) ---------- */
function openTelegram(){
  const deepLink = "tg://resolve?domain=" + BOT_USERNAME + "&start=verify";
  const webFallback = "https://t.me/" + BOT_USERNAME + "?start=verify";

  // Try opening Telegram app
  window.location.href = deepLink;

  // Fallback to web after 1.2s (if app not installed)
  setTimeout(() => {
    window.location.href = webFallback;
  }, 1200);
}

/* ---------- SHOW VERIFIED SCREEN ---------- */
function showVerifiedScreen(){
  document.getElementById("stepBox").innerHTML = `
    <h2 style="color:#22c55e;">Verification Completed</h2>

    <div class="timer">
      ${CHECK_SVG}
      READY
    </div>

    <div class="desc">
      Tap below to return to Telegram and complete verification.
    </div>

    <button class="tg" onclick="openTelegram()">
      Continue to Telegram
    </button>
  `;
}

/* ---------- HANDLE BACK ---------- */
document.addEventListener("visibilitychange", () => {
  if (document.visibilityState === "visible") {
    const done = sessionStorage.getItem("verified_step");
    const t = sessionStorage.getItem("ad_time");
    
    if (done && t) {
      const diff = Date.now() - parseInt(t, 10);
      
      // Telegram ke liye realistic threshold
      if (diff >= 6000) {
        showVerifiedScreen();
      }
    }
  }
});

/* ---------- COUNTDOWN ---------- */
let time = 10;
const count = document.getElementById("count");
const btn = document.getElementById("btn");

if (btn) {
  const timer = setInterval(() => {
    time--;
    count.innerText = time;

    if (time <= 0) {
      clearInterval(timer);
      count.innerHTML = CHECK_SVG;
      btn.classList.add("active");
      btn.disabled = false;
    }
  }, 1000);

  btn.onclick = () => {
  if (!btn.classList.contains("active")) return;

  sessionStorage.setItem("verified_step","done");
  sessionStorage.setItem("ad_time", Date.now());

  // open ad in new tab / window
  window.open(AD_LINK, "_blank", "noopener,noreferrer");

  // instantly show verified screen
  showVerifiedScreen();
};
}
</script>

</body>
</html>
